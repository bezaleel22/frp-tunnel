services:
  proxy-tunnel:
    build:
      context: .
      args:
        HOST_SSH_PORT: ${HOST_SSH_PORT}
    networks:
      - dokploy-network
    extra_hosts:
      - "host.docker.internal:host-gateway"
    labels:
      # Traefik TCP router to expose SSH port (example)
      - "traefik.enable=true"
      - "traefik.tcp.routers.node-tunnel.rule=HostSNI(`${DOMAIN_NAME}`)"
      - "traefik.tcp.routers.node-tunnel.entrypoints=websecure"
      - "traefik.tcp.routers.node-tunnel.tls=true"
      - "traefik.tcp.services.node-tunnel.loadbalancer.server.port=80"

networks:
  dokploy-network:
    external: true